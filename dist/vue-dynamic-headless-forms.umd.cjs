(function(u,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue"),require("@vuelidate/validators"),require("@vuelidate/core")):typeof define=="function"&&define.amd?define(["exports","vue","@vuelidate/validators","@vuelidate/core"],r):(u=typeof globalThis<"u"?globalThis:u||self,r(u["vue-dynamic-headless-forms"]={},u.Vue,u["@vuelidate/validators"],u["@vuelidate/core"]))})(this,function(u,r,t,c){"use strict";const p=r.defineComponent({__name:"DynamicFormField",props:r.mergeModels({field:{},context:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const l=r.useModel(o,"modelValue"),g=o,{field:i,context:a}=r.toRefs(g);function v(n){l.value=n}const T=r.computed(()=>{const n={};for(const e of i.value.validationRules||[])console.debug("Add validation rule: ",e),e.name=="required"&&(n.required=t.helpers.withMessage(e.errorText,t.required)),e.name=="required_if"&&(n.requiredIf=t.helpers.withMessage(e.errorText,t.requiredIf(!!a.value[e.otherFieldName]))),e.name=="required_unless"&&(n.requiredUnless=t.helpers.withMessage(e.errorText,t.requiredUnless(!!a.value[e.otherFieldName]))),e.name=="min_length"&&(n.minLength=t.helpers.withMessage(e.errorText,t.minLength(e.length))),e.name=="max_length"&&(n.maxLength=t.helpers.withMessage(e.errorText,t.maxLength(e.length))),e.name=="less_than"&&(n.lessThan=t.helpers.withMessage(e.errorText,t.maxValue(e.value))),e.name=="greater_than"&&(n.greaterThan=t.helpers.withMessage(e.errorText,t.minValue(e.value))),e.name=="same_as"&&(n.sameAs=t.helpers.withMessage(e.errorText,t.sameAs(a.value[e.otherFieldName])));return n}),y=r.computed(()=>({model:l.value})),x=r.computed(()=>({model:{...T.value}}));function d(n){function e(s){if(s.fieldType==="list")return[e(s.itemDefinition)];if(s.fieldType==="object"){let m={};for(const h of s.itemProperties||[])m[h.name]=e(h);return m}return JSON.parse(JSON.stringify(s.default))}return JSON.parse(JSON.stringify(e(n)))}const f=c(x,y);return r.onMounted(()=>{i.value.default&&(l.value===null||l.value===void 0)?l.value=JSON.parse(JSON.stringify(i.value.default)):i.value.fieldType==="object"&&(l.value===null||l.value===void 0)?l.value=d(i.value):i.value.fieldType==="list"&&(l.value===null||l.value===void 0)&&(l.value=new Array)}),(n,e)=>r.renderSlot(n.$slots,r.unref(i).fieldType,{field:r.unref(i),modelValue:l.value,setModelValue:v,getDefaultValue:d,errorMessages:r.unref(f).$error?r.unref(f).$errors.map(s=>s.$message):[]})}});u.DynamicFormField=p,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
